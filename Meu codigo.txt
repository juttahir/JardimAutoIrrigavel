
#include <Wire.h>
#include <LiquidCrystal_I2C.h>

LiquidCrystal_I2C lcd(0x27,16,2);

const int pinoSensor = A0;
int valorLido;

int Borrifador01 = 4;
int Borrifador02 = 5;

int analogSoloSeco = 1023; //VALOR MEDIDO COM O SOLO SECO (VOCÊ PODE FAZER TESTES E AJUSTAR ESTE VALOR)
int analogSoloMolhado = 0; //VALOR MEDIDO COM O SOLO MOLHADO (VOCÊ PODE FAZER TESTES E AJUSTAR ESTE VALOR)
int percSoloSeco = 0; //MENOR PERCENTUAL DO SOLO SECO (0% - NÃO ALTERAR)
int percSoloMolhado = 100; //MAIOR PERCENTUAL DO SOLO MOLHADO (100% - NÃO ALTERAR)

int umidadeSolo = 55;

int LeituraSolo = analogRead(pinoSensor);
int Limite = 100;
int idealPlantas = 75;

void setup(){

 lcd.init();
  
 pinMode(Borrifador01, OUTPUT);
 pinMode(Borrifador02, OUTPUT);
 Serial.begin(9600); //INICIALIZA A SERIAL
 Serial.println("Lendo a umidade do solo Bonsai...");
 delay(2000);
}

void loop(){

    lcd.clear();
     
     valorLido = constrain(analogRead(pinoSensor),analogSoloMolhado,analogSoloSeco);
     valorLido = map(valorLido,analogSoloMolhado,analogSoloSeco,percSoloMolhado,percSoloSeco);
     Serial.print("Umidade do solo das plantas: ");
     Serial.print(valorLido);
     Serial.println("%");
     lcd.setBacklight(HIGH);
     lcd.setCursor(0,0);
     lcd.print("Umidade do solo");
     lcd.setCursor(0,1);
     lcd.print("Plantas: ");
     lcd.print(valorLido);
     lcd.print("%");
     delay(1000);
     
  if(valorLido <= umidadeSolo){
     while(valorLido != idealPlantas){
     Serial.println("Irrigando plantas");
     lcd.print("Irrigando plantas");
     digitalWrite(Borrifador01, LOW);
     digitalWrite(Borrifador02, LOW);
     break;
     }
  }
  if(valorLido >= idealPlantas){
     digitalWrite(Borrifador01, HIGH);
     digitalWrite(Borrifador02, HIGH);
  }
  }
